# LostArk Marketplace API Service

λ΅μ¤νΈμ•„ν¬ μ¤ν” API μ—°λ™ μ΄μ»¤λ¨Έμ¤ μ„λΉ„μ¤

## π“ ν”„λ΅μ νΈ κ°μ”

μ΄ ν”„λ΅μ νΈλ” **λ΅μ¤νΈμ•„ν¬ μ¤ν” API**μ™€ ν†µν•© μ΄μ»¤λ¨Έμ¤ API μ„λΉ„μ¤λ¥Ό μ κ³µν•©λ‹λ‹¤.

μ μ €λ” μμ‹ μ μΊλ¦­ν„° μ •λ³΄λ¥Ό μ—°λ™ν•΄ κ²μ„ λ‚΄ μ¬ν™”λ΅ μ•„μ΄ν…μ„ κµ¬λ§¤ν•κ±°λ‚ λ³΄λ„μ¤ ννƒμ„ μ§€κΈ‰λ°›μ„ μ μμµλ‹λ‹¤.

## π›  κΈ°λ¥ μ„¤λ…

### 1οΈβƒ£ νμ› μ •λ³΄ (ν•„μ μ‚¬ν•­)

**μ„¤λ…**

- μ μ €λ” λ΅μ¤νΈμ•„ν¬ μΊλ¦­ν„° μ •λ³΄λ¥Ό μ—°λ™ν•μ—¬ νμ› μ •λ³΄λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **ν”„λ΅ν•„ μ΅°ν λ° μμ •**:
    - `Spring Data JPA`λ¥Ό ν™μ©ν•΄ μ μ € μ •λ³΄ CRUD μν–‰.
    - λΉ„λ°€λ²νΈ λ³€κ²½ μ‹ `BCrypt` μ•”νΈν™” μ μ©.
    - `JWT`λ¥Ό ν†µν• μΈμ¦μΌλ΅ κ°μΈμ •λ³΄ μ ‘κ·Ό μ μ–΄.
- **λ΅μ¤νΈμ•„ν¬ μΊλ¦­ν„° μ—°λ™**:
    - λ΅μ¤νΈμ•„ν¬ μ¤ν” APIλ΅ μΊλ¦­ν„° λ©λ΅ λ° λ¥λ ¥μΉλ¥Ό λ¶λ¬μ™€ μ €μ¥.
- **κµ¬λ§¤ λ° κ²°μ  λ‚΄μ—­ μ΅°ν**:
    - DBμ™€ μ—°λ™ν•΄ `Spring Data JPA`λ΅ κ²°μ  μ΄λ ¥ κ΄€λ¦¬.
    - νμ΄μ§• μ²λ¦¬λ¥Ό μ μ©ν•΄ λ‚΄μ—­μ„ λ¶„ν•  μ΅°ν.
- **λΉ„λ°€λ²νΈ μ΄κΈ°ν™”**:
    - λλ¤ν• λΉ„λ°€λ²νΈ μƒμ„± ν›„ μ‘λ‹µ λ°ν™ λ° `Spring Data JPA`λ¥Ό ν†µν•΄ DBμ— λ°μ.

### 2οΈβƒ£ Market μ •λ³΄ μ‹¤μ‹κ°„ κ°±μ‹  (ν•„μ μ‚¬ν•­)

**μ„¤λ…**

- λ΅μ¤νΈμ•„ν¬ μ¤ν” APIμ Market μ •λ³΄λ¥Ό 5λ¶„λ§λ‹¤ μ£ΌκΈ°μ μΌλ΅ νΈμ¶ν•μ—¬ DBμ— μ €μ¥ν•©λ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **DB μ €μ¥**:
    - `Spring Scheduler` λ¥Ό μ‚¬μ©ν•΄ 5λ¶„λ§λ‹¤ λ΅μ¤νΈμ•„ν¬ μ¤ν” APIμ—μ„ μµμ‹  Market μ •λ³΄λ¥Ό λ¶λ¬μ™€ DBμ— μ €μ¥.
- **λ°μ΄ν„° μ‘λ‹µ μµμ ν™”**:
    - ν΄λΌμ΄μ–ΈνΈ μ”μ²­ μ‹λ§λ‹¤ DBμ—μ„ λ°μ΄ν„°λ¥Ό μ΅°νν•μ—¬ μµμ‹  μƒνƒλ¥Ό μ μ§€ν•©λ‹λ‹¤.

### 3οΈβƒ£ μƒν’λ… κ²€μƒ‰ κΈ°λ¥ (ν•„μ μ‚¬ν•­)

**μ„¤λ…**

- Marketμ—μ„ κµ¬λ§¤ν•λ ¤λ” μƒν’μ„ κ²€μƒ‰ν•  μ μμµλ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **μƒν’λ… μλ™ μ™„μ„±**:
    - **Elasticsearch**μ κ°•λ ¥ν• κ²€μƒ‰ κΈ°λ¥μ„ ν™μ©ν•μ—¬ μ…λ ¥λ κ²€μƒ‰μ–΄μ™€ μΌμΉν•λ” μƒν’λ…μ„ λΉ λ¥΄κ² μ¶”μ².
    - μ μ‚¬λ„ κΈ°λ° κ²°κ³Ό μ κ³µ.
    - μ‹¤μ‹κ°„μΌλ΅ Market λ°μ΄ν„°λ¥Ό Elasticsearchμ— μ €μ¥ν•μ—¬ μλ™ μ™„μ„± κΈ°λ¥μ„ μµμ ν™”.
- **ν•„ν„° κΈ°λ¥**:
    - `Specification`κ³Ό λ™μ  `LIKE` μΏΌλ¦¬λ¥Ό μ‚¬μ©ν•΄ μƒν’λ…μ„ ν¬ν•¨ν•μ—¬ μƒν’λ…, λ“±κΈ‰, κ°€κ²© μ΅°κ±΄μΌλ΅ κ²€μƒ‰ ν•„ν„°λ§μ„ μ§€μ›.
    - `Page`μ™€Β `Pageable`Β κ°μ²΄λ¥Ό ν†µν•΄ μλ™ μ™„μ„± κ²°κ³Όλ¥Ό νμ΄μ§€ λ‹¨μ„λ΅ μ κ³µ.

### 4οΈβƒ£ μΈκ²μ„ μ¬ν™” λ° ν¬μΈνΈλ΅ κµ¬λ§¤ κΈ°λ¥ (ν•„μ μ‚¬ν•­)

**μ„¤λ…**

- κ²μ„μ—μ„ νλ“ν• μΈκ²μ„ μ¬ν™”(κ³¨λ“)μ™€ ν¬μΈνΈλ¥Ό ν™μ©ν•΄ μ΄μ»¤λ¨Έμ¤ Marketμ—μ„ μ•„μ΄ν…μ„ κµ¬λ§¤ν•©λ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **κ³¨λ“ κ²°μ **:
    - μ μ €μ μ”μ—¬ κ³¨λ“λ¥Ό ν™•μΈν•κ³  κ²°μ  μ²λ¦¬.
    - **κ³¨λ“ λ¶€μ΅± μ‹** κ²°μ  μ‹¤ν¨ λ©”μ‹μ§€λ¥Ό μ „λ‹¬.
- **κµ¬λ§¤ ν™•μ • μ‹ μΈλ²¤ν† λ¦¬ λ°μ**:
    - κ²°μ  μ™„λ£ ν›„ μ μ €μ μΈλ²¤ν† λ¦¬μ— μƒν’ μ •λ³΄ λ°μ.
    - μ¬κ³  κ΄€λ¦¬ λ° λ™μ‹μ„± λ¬Έμ  ν•΄κ²°μ„ μ„ν• **λ½(Lock) μ²λ¦¬**.
- **ν™λ¶ κΈ°λ¥**:
    - κµ¬λ§¤ μ·¨μ† μ‹ κµ¬λ§¤ μ΄λ ¥μ„ ν™•μΈν•μ—¬ ν™λ¶ μ²λ¦¬.
- **κ²°μ  μ‹ ν¬μΈνΈ μ λ¦½**:
    - `Spring Event Listener`λ¥Ό μ‚¬μ©ν•΄ κ²°μ  μ„±κ³µ μ‹ ν¬μΈνΈ μ λ¦½ μ΄λ²¤νΈ νΈλ¦¬κ±°.

### 5οΈβƒ£ μ¥λ°”κµ¬λ‹ κΈ°λ¥ (ν•„μ μ‚¬ν•­)

**μ„¤λ…**

- μ μ €κ°€ μƒν’μ„ μ¥λ°”κµ¬λ‹μ— λ‹΄μ•„ κ΄€λ¦¬ν•κ³  κ²°μ ν•  μ μμµλ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **μƒν’ λ‹΄κΈ°**:
    - λ™μΌ μƒν’ μ„ νƒ μ‹ μλ‰μ΄ μλ™ μ¦κ°€.
- **μλ‰ λ³€κ²½ λ° μ‚­μ **:
    - μ¥λ°”κµ¬λ‹μ μλ‰ μ΅°μ • λ° μ‚­μ  μ²λ¦¬.
- **μ¥λ°”κµ¬λ‹ μ΅°ν**:
    - μ¥λ°”κµ¬λ‹ μ΄ κ°€κ²©κ³Ό κ²°μ μ— ν•„μ”ν• μ¬ν™”λ¥Ό κ³„μ‚°ν•΄ μ κ³µ.
- **μ¥λ°”κµ¬λ‹ κ²°μ **:
    - κ²°μ  μ‹ DBμ— κµ¬λ§¤ μ΄λ ¥μ„ μ €μ¥.

### 6οΈβƒ£ ν¬μΈνΈ μ λ¦½ κΈ°λ¥ (μ„ νƒ μ‚¬ν•­)

**μ„¤λ…**

- μ μ €κ°€ κ²°μ ν• κΈμ•΅μ— λ”°λΌ ν¬μΈνΈλ¥Ό μ λ¦½ν•΄ μ¶”κ°€ ννƒμ„ μ κ³µν•©λ‹λ‹¤.

**μ„Έλ¶€ κΈ°λ¥**

- **μΌλ° ν¬μΈνΈ μ λ¦½**:
    - κ²°μ  κΈμ•΅μ 3%λ¥Ό ν¬μΈνΈλ΅ μ λ¦½.
    - `Spring Event Listener`λ΅ ν¬μΈνΈ μ λ¦½ νΈλ¦¬κ±° λ°μƒ.
- **νΉμ • λ λ²¨ μ΄μƒ μ‹ μ°¨λ“± μ λ¦½**:
    - νΉμ • λ λ²¨ μ΄μƒμ€ μµλ€ 10%κΉμ§€ μ°¨λ“± μ λ¦½.
    - λ΅μ¤νΈμ•„ν¬ μ¤ν” APIλ΅ νΉμ • λ λ²¨ μ΅°κ±΄ ν™•μΈ.
- **ν¬μΈνΈ μ ν¨ κΈ°κ°„**:
    - 6κ°μ›” λ‚΄ μ‚¬μ© μ ν•.
- **ν¬μΈνΈ νμ**:
    - **κµ¬λ§¤ μ·¨μ† μ‹** μ λ¦½λ ν¬μΈνΈλ” νμ. λ‹¨, μ΄λ―Έ μ‚¬μ©ν• ν¬μΈνΈλ” μ°¨κ°ν•μ§€ μ•μ.

## π§‘β€π’» κΈ°μ  μ¤νƒ

- **Language**: Java 17
- **Framework**: Spring Boot 3.3.4
- **Build Tool**: Gradle
- **Database**:
    - **Production**: MariaDB
    - **Development**: H2 Database
    - **Search Engine**: Elasticsearch
- **ORM**: JPA (Java Persistence API)
- **Library**:
    - Lombok
    - Hibernate Validator
    - Apache Commons Collections 4
    - JPA Specification
- **Security**:
    - Spring Security
    - JWT (JSON Web Token)
- **Batch Processing**: Spring Scheduler (Batch μ‘μ—…μΌλ΅ Market μ •λ³΄ μ£ΌκΈ°μ  κ°±μ‹ )
- **Event Handling**: Spring Event Listener (ν¬μΈνΈ μ λ¦½ λ° κΈ°νƒ€ μ΄λ²¤νΈ μ²λ¦¬)
- **Test**: Junit5
- **Server**: Embedded Tomcat
- **Open API**: LostArk Open API (μΊλ¦­ν„°, κ±°λμ† μ •λ³΄ μ—°λ™)
- **IDE**: Eclipse

## π“‚ ν”„λ΅μ νΈ κµ¬μ΅°

1. **νμ› μ •λ³΄ κ΄€λ¦¬**: μ μ €μ λ΅μ¤νΈμ•„ν¬ κ³„μ •κ³Ό ν”„λ΅ν•„ κ΄€λ¦¬
2. **Market μ •λ³΄ μ‹¤μ‹κ°„ κ°±μ‹ **: Spring Schedulerλ¥Ό μ‚¬μ©ν•΄ Market λ°μ΄ν„° μ‹¤μ‹κ°„ λ°μ
3. **μƒν’ κ²€μƒ‰ κΈ°λ¥**: Elasticsearchλ¥Ό ν†µν• μ‹¤μ‹κ°„ μλ™ μ™„μ„±, ν•„ν„°λ§μ„ ν†µν• μƒν’ νƒμƒ‰
4. **μΈκ²μ„ μ¬ν™” λ° ν¬μΈνΈλ΅ κµ¬λ§¤ κΈ°λ¥**: μ¬ν™” κ²°μ  λ° μΈλ²¤ν† λ¦¬ λ°μ
5. **μ¥λ°”κµ¬λ‹ κΈ°λ¥**: μƒν’ μ¶”κ°€, μ΅°ν λ° κ²°μ  μ²λ¦¬
6. **ν¬μΈνΈ μ λ¦½ λ° λ³΄μƒ**: κ²°μ  κΈμ•΅μ— λ”°λ¥Έ ν¬μΈνΈ μ κ³µ

## π’Ύ ERD
<img src="https://github.com/user-attachments/assets/9cb83e4e-7600-42d8-bfce-a2bdc491b9f2" width="800" height="550"/>  

## π”— API μ—°λ™ μ •λ³΄  
- **LostArk Open API**λ¥Ό ν™μ©ν•΄ **μΊλ¦­ν„° μ •λ³΄**μ™€ **κ±°λμ† μ •λ³΄**λ¥Ό λ¶λ¬μµλ‹λ‹¤.  

## π› οΈ Trouble Shooting
<a href="https://www.notion.so/Trouble-Shooting-124518e1879e801da845df0266401597">
    <img src="https://skillicons.dev/icons?i=notion" />
</a>
